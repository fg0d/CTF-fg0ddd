import requests
import urllib
import re
import hashlib

sessid = "rh5skqbjvbu9o26fu37n3qgos5"
url = "https://ringzer0team.com/challenges/14"
session = requests.session()
request = session.get(url, cookies={"PHPSESSID":sessid})
raw = request.text
begin = raw.find("----- BEGIN MESSAGE -----")+35
end = raw.find("----- END MESSAGE -----")-10

question = raw[begin:end]
chars = ""
bits = re.findall("........", question) #split by 8
print(bits)
for x in bits:
	chars += (chr(int(x, 2)))
print("TEST : ", chars)
cipher = hashlib.sha512(chars.encode('utf-8'))
result = cipher.hexdigest()

sendurl = url + "/" + result
solution = session.get(sendurl, cookies={"PHPSESSID":sessid})
print(sendurl)
flag = solution.text.find("FLAG-")
last = solution.text[:flag+50]
print("FLAG : ", solution.text[3826:4000])
