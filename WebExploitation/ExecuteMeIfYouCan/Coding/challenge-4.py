import requests
import re
import urllib

#url
url = "https://ringzer0team.com/challenges/32"
sessId = "19em8riu1fjn3vqpbisqc8s1i6"
session = requests.session()

#get data function
def get_data():
	request = session.get(url, cookies={"PHPSESSID":sessId})
	raw = request.text
	begin = raw.find("----- BEGIN MESSAGE -----")+35
	end = raw.find("----- END MESSAGE -----")-10
	content = raw[begin:end]
	print("content : ", content)
	return content

def extract_data():
	data = get_data()
	regex = r'(\w+)'
	extraction = re.findall(regex, data)
	print("REGEX : ", extraction)
	result = int(extraction[0], 10) + int(str(extraction[1]), 16) - int(str(extraction[2]), 2)
	print("RESULT : ", result)
	get_flag(result)

def get_flag(ans):
	flag_url = url + "/" + str(ans)
	print("ANS : ", flag_url)
	request = session.get(flag_url, cookies={"PHPSESSID":sessId})
	raw = request.text
	regex = r'FLAG-(\w+)'
	palag = re.findall(regex, raw)
	print("FLAG : ", palag[0])

#main function (controller function)
def main():
	print("Starting...")
	extract_data()
	print("Done!")

if __name__ == "__main__":
	main()