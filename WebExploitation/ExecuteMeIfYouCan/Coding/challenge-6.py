import requests
import re
import urllib
import hashlib

#base variables
url = "https://ringzer0team.com/challenges/56"
sessId = "19em8riu1fjn3vqpbisqc8s1i6"
session = requests.session()

#get data function
def get_data():
	request = session.get(url, cookies={"PHPSESSID":sessId})
	raw = request.text
	begin = raw.find("----- BEGIN HASH -----")+32
	end = raw.find("----- END HASH -----")-10
	content = raw[begin:end]
	#print("RAW : ", raw)
	print("HASH1 : ", content)
	return content

#random generate
def generate_tmp_hash(n):
	tmp_hash = hashlib.sha1(str(n).encode())
	return tmp_hash.hexdigest()
	
#get flag
def get_flag(result):
	flag_url = url + "/" + str(result)
	print("FLAG URL : ", flag_url)
	request = session.get(flag_url, cookies={"PHPSESSID":sessId})
	raw = request.text
	regex = r'FLAG-(\w+)'
	palag = re.findall(regex, raw)
	print("FLAG : ", palag)

#hash break
def break_hash():
	content_hash = get_data()
	for i in range(999,10000):
		tmp_hash = generate_tmp_hash(i)
		if content_hash == tmp_hash:
			get_flag(i)



#main function (controller function)
def main():
	break_hash()

if __name__ == "__main__":
	main()