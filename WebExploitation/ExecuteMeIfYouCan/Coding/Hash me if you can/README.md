# Write Up

This is write up for ringzer0team.com
Coding task level 1 - Hash me if you can

## Getting Started

Given task is simple as it says we have 2 second to hash the following message using sha512 algorithm :
```
----- BEGIN MESSAGE -----
SPT2bu3Pwzef5Dk3Vmyea0Y1p28aIjtqYdiZxcFUBJ0xcbqYoP2oFRfVKdVimfzbiI1GKwqb5hz8iPWwvPK0wPM7Txf6CE7LdZhNlyPhFefOU2afHL64rI1a576yC4aFTii5GXdc2jRMbRSJtODKmvLisIHVCHqmPyimmlpev6RxOz68dAJqWkzfS60lEgxkFGxSSMXdJEAo3xm7XVoJ6OOOLEZfLnqgTNZBqMFZg5dasq8gbnP71uMCZCIAPZHzCw1S9wIfrMgK2eQ4sw2jREMG7l7NaFcC23l1qT7IvdjniZhAmaK3FmACyyfy4i0WccOsVL0gP9uYZCpcCZ67cxAAVFYPNPCPRg8DSZKxY4lOxAR0qNYsaoTWTIBxn3d5abyS19fQ3rurSbh9P5rPjbB3J3rXXuSXwhFngL3a2orLqyK5t2LD3dwC6NpT88HvfcJmNDmGRDh81S3lKFODIa6FOmpNkW8qZICDbO9ThhR9ZLkAhY4PZ0lEcAhnngDcP5FQJFARNiQDU031PYHFOS9Rjh4woyz3t5J3BaKeiqH2hBUXprs49sMjzHGN55Ho0girhSwp94ihw24LknGkGit6PZJKUgZLn73vQqLPkTWGMRiW5O6BWqxCf7d0e3Cs1vNHMonW8asKRBxMfue2LBvQyyHCr9VivyP7M3UL3dmKEKnK4sCFTXmimULDUwLfUrdxkX9e1lPvV25Qkym4mycyiO12aD8VVci60iaRtPdfI8VTx7NJwQ8Fu0yvtwgfzpcpxc7QSaVr9HawEO61u4wPUUaehhkHwmXTpUA7VmoUTpho3efo8B4Tm5Xuc71ykOhzyIxkUM4D1cRVgX9fp4YBZMV1KNpUrxjQ5G0QjVjaY1V4PVa4QYvFBhwbVMVca5T6CJMLvWLjOxetjfnZ3JuvRRwCuhFucorEY4gkQRuvfyOoD2dxCxSkffNzmiUpxcUl60wNIQ8NeN1IF468sPiyUVY74ImrL7DHYZkwFj9KW1jsWgqeVzCFlqDfZQwB
----- END MESSAGE -----

```
But the there is some troubles. The page generates the message randomly in every 2 second (I guess). So after 2 second the hash of the message will expire. So we will write little script in python.

```
import requests
import urllib
import re
import hashlib

sessid = "rh5skqbjvbu9o26fu37n3qgos5"
url = "https://ringzer0team.com/challenges/13"
session = requests.session()
request = session.get(url, cookies={"PHPSESSID":sessid})
raw = request.text
begin = raw.find("----- BEGIN MESSAGE -----")+35
end = raw.find("----- END MESSAGE -----")-10

question = raw[begin:end]
cipher = hashlib.sha512(question.encode('utf-8'))
result = cipher.hexdigest()

sendurl = url + "/" + result
solution = session.get(sendurl, cookies={"PHPSESSID":sessid})
print(sendurl)
flag = solution.text.find("FLAG-")
last = solution.text[:flag+50]
print("FLAG : ", solution.text[3826:4000])

```
the code will do as following : 
 - First we get PHPSESSID. So server can now that you are sending requests
 - Next we have to get the message. So we will request to server by doing 'session.get(sendurl, cookies={"PHPSESSID":sessid})'
 - After we get response convert response to text and get only message from the response by slicing the text 'raw[begin:end]'
 - Now we have to hash the message using sha512 algorithm. In order to do that we use hashlib in python 'hashlib.sha512(question.encode('utf-8'))'
 - And we will send the hash string to server by adding hash string to server url
Thats all we get the flag after successfully sending request. What I did to last section of the script is just slice the flag from response text by doing :

```
flag = solution.text.find("FLAG-")
last = solution.text[:flag+50]
```
