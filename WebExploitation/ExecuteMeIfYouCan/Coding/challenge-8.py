import urllib
import hashlib
import re
import requests
import time

#base data
url = "https://ringzer0team.com/challenges/57"
sessId = "dmhk8gcl6muhcs90eav1sicod3"
session = requests.session()
content = ""

#get content
def get_data():
	global content
	request = session.get(url, cookies={"PHPSESSID":sessId})
	raw = request.text
	begin = raw.find("----- BEGIN HASH -----")+32
	end = raw.find("----- END HASH -----")-10
	content = raw[begin:end]
	saltBegin = raw.find("----- BEGIN SALT -----")+32
	saltEnd = raw.find("----- END SALT -----")-10
	salty = raw[saltBegin:saltEnd]
	print("CONTENT : ", content)
	print("SALT : ", salty)
	return salty

#break hash
def break_hash(salt):
	global content
	print("CONTENT : ", content)
	for i in range(999, 10000):
		tmpPlain = str(i)+salt
		tmpHash = hashlib.sha1(str(tmpPlain).encode()).hexdigest()
		if content == tmpHash:
			print("MY HASH : ", tmpHash)
			return i


#send result
def get_flag(data):
	flag_url = url + "/" + str(data)
	request = session.get(flag_url, cookies={"PHPSESSID":sessId})
	raw = request.text
	regex = r'FLAG-(\w+)'
	palag = re.findall(regex, raw)
	flag = "FLAG-"+str(palag)
	print(flag)
	print(flag_url)

if __name__ == "__main__":
	raw_salt = get_data()
	result = break_hash(raw_salt)
	print(result)
	get_flag(result)